/*
 BSD

 Copyright (c) 2010-2014 Christian Johansen
 BSD

 Copyright (c) 2010-2013 Christian Johansen
 BSD

 Copyright (c) 2010-2013 Christian Johansen
 BSD

 Copyright (c) 2010-2014 Christian Johansen
 BSD

 Copyright (c) 2012 Maximilian Antoni
 BSD

 Copyright (c) 2010-2014 Christian Johansen
 BSD

 Copyright (c) 2010-2013 Christian Johansen
 Copyright (c) 2013 Maximilian Antoni
 BSD

 Copyright (c) 2010-2013 Christian Johansen
 BSD

 Copyright (c) 2010-2013 Christian Johansen
 BSD

 Copyright (c) 2010-2013 Christian Johansen
 BSD

 Copyright (c) 2010-2013 Christian Johansen
 BSD

 Copyright (c) 2010-2013 Christian Johansen
 BSD

 Copyright (c) 2010-2013 Christian Johansen
 BSD

 Copyright (c) 2011 Sven Fuchs, Christian Johansen
 BSD

 Copyright (c) 2010-2014 Christian Johansen
 BSD

 Copyright (c) 2010-2013 Christian Johansen
 BSD

 Copyright (c) 2010-2013 Christian Johansen
 BSD

 Copyright (c) 2010-2013 Christian Johansen
 BSD

 Copyright (c) 2010-2013 Christian Johansen
 BSD

 Copyright (c) 2010-2013 Christian Johansen
 BSD

 Copyright (c) 2010-2013 Christian Johansen
 BSD

 Copyright (c) 2010-2013 Christian Johansen
*/
(function(x,w){"function"===typeof define&&define.amd?define("sinon",[],function(){return x.sinon=w()}):"object"===typeof exports?module.exports=w():x.sinon=w()})(this,function(){var x,w,K;(function(){function h(h,m,a){"samsam"==h?x=m():"function"===typeof m&&0===h.length?K=m():"function"===typeof a&&(w=a(x))}h.amd={};("function"===typeof h&&h.amd&&function(n){h("samsam",n)}||"object"===typeof module&&function(h){module.exports=h()}||function(h){this.samsam=h()})(function(){function h(b){return"number"===
typeof b&&b!==b}function m(a){return b.toString.call(a).split(/[ \]]/)[1]}function a(b){if("Arguments"===m(b))return!0;if("object"!==typeof b||"number"!==typeof b.length||"Array"===m(b))return!1;if("function"==typeof b.callee)return!0;try{b[b.length]=6,delete b[b.length]}catch(a){return!0}return!1}function l(b){if(!b||1!==b.nodeType||!p)return!1;try{b.appendChild(p),b.removeChild(p)}catch(a){return!1}return!0}function g(a){var e=[],k;for(k in a)b.hasOwnProperty.call(a,k)&&e.push(k);return e}function f(b){return"function"==
typeof b.getTime&&b.getTime()==b.valueOf()}function d(b){return 0===b&&-Infinity===1/b}function c(b,a){if(b===a||h(b)&&h(a))return 0!==b||d(b)===d(a)}function k(b,a){if(0===a.length)return!0;var k,c,p;k=0;for(c=b.length;k<c;++k)if(e(b[k],a[0])){c=0;for(p=a.length;c<p;++c)if(!e(b[k+c],a[c]))return!1;return!0}return!1}var b=Object.prototype,p="undefined"!==typeof document&&document.createElement("div"),e;e=function s(b,a){if(a&&"function"===typeof a.test)return a.test(b);if("function"===typeof a)return!0===
a(b);if("string"===typeof a)return a=a.toLowerCase(),("string"===typeof b||!!b)&&0<=String(b).toLowerCase().indexOf(a);if("number"===typeof a||"boolean"===typeof a)return a===b;if("undefined"===typeof a)return"undefined"===typeof b;if(null===a)return null===b;if("Array"===m(b)&&"Array"===m(a))return k(b,a);if(a&&"object"===typeof a){if(a===b)return!0;for(var e in a){var c=b[e];"undefined"===typeof c&&"function"===typeof b.getAttribute&&(c=b.getAttribute(e));if(null===a[e]||"undefined"===typeof a[e]){if(c!==
a[e])return!1}else if("undefined"===typeof c||!s(c,a[e]))return!1}return!0}throw Error("Matcher was not a string, a number, a function, a boolean or an object");};return{isArguments:a,isElement:l,isDate:f,isNegZero:d,identical:c,deepEqual:function(e,k){function p(b){return"object"!==typeof b||null===b||b instanceof Boolean||b instanceof Date||b instanceof Number||b instanceof RegExp||b instanceof String?!1:!0}function d(b,a){var e;for(e=0;e<b.length;e++)if(b[e]===a)return e;return-1}var u=[],t=[],
q=[],v=[],B={};return function L(e,k,r,s){var D=typeof e,I=typeof k;if(e===k||h(e)||h(k)||null==e||null==k||"object"!==D||"object"!==I)return c(e,k);if(l(e)||l(k))return!1;var E=f(e),A=f(k);if(E||A)if(!E||!A||e.getTime()!==k.getTime())return!1;if(e instanceof RegExp&&k instanceof RegExp&&e.toString()!==k.toString())return!1;var A=m(e),F=m(k),E=g(e),G=g(k);if(a(e)||a(k)){if(e.length!==k.length)return!1}else if(D!==I||A!==F||E.length!==G.length)return!1;for(var y,w,x,J,H,D=0,I=E.length;D<I;D++){y=E[D];
if(!b.hasOwnProperty.call(k,y))return!1;A=e[y];F=k[y];G=p(A);w=p(F);x=G?d(u,A):-1;J=w?d(t,F):-1;H=-1!==x?q[x]:r+"["+JSON.stringify(y)+"]";y=-1!==J?v[J]:s+"["+JSON.stringify(y)+"]";if(B[H+y])break;-1===x&&G&&(u.push(A),q.push(H));-1===J&&w&&(t.push(F),v.push(y));G&&w&&(B[H+y]=!0);if(!L(A,F,H,y))return!1}return!0}(e,k,"$1","$2")},match:e,keys:g}});("function"===typeof h&&h.amd&&function(n){h("formatio",["samsam"],n)}||"object"===typeof module&&function(h){module.exports=h(require("samsam"))}||function(h){this.formatio=
h(this.samsam)})(function(h){function m(a){return a?a.displayName?a.displayName:a.name?a.name:(a=a.toString().match(/function\s+([^\(]+)/m))&&a[1]||"":""}function a(a,b){var c=m(b&&b.constructor),e=a.excludeConstructors||d.excludeConstructors||[],f,g;f=0;for(g=e.length;f<g;++f)if("string"===typeof e[f]&&e[f]===c||e[f].test&&e[f].test(c))return"";return c}function l(a,b){if("object"!==typeof a)return!1;var c,e;c=0;for(e=b.length;c<e;++c)if(b[c]===a)return!0;return!1}function g(a,b,p,e){if("string"===
typeof b)return a=a.quoteStrings,p||"boolean"!==typeof a||a?'"'+b+'"':b;if("function"===typeof b&&!(b instanceof RegExp))return g.func(b);p=p||[];if(l(b,p))return"[Circular]";if("[object Array]"===Object.prototype.toString.call(b))return g.array.call(a,b,p);if(!b)return String(-Infinity===1/b?"-0":b);if(h.isElement(b))return g.element(b);if("function"===typeof b.toString&&b.toString!==Object.prototype.toString)return b.toString();var d,f;d=0;for(f=c.length;d<f;d++)if(b===c[d].object)return c[d].value;
return g.object.call(a,b,p,e)}function f(a){for(var b in a)this[b]=a[b]}var d={excludeConstructors:["Object",/^.$/],quoteStrings:!0,limitChildrenCount:0},c=[];"undefined"!==typeof global&&c.push({object:global,value:"[object global]"});"undefined"!==typeof document&&c.push({object:document,value:"[object HTMLDocument]"});"undefined"!==typeof window&&c.push({object:window,value:"[object Window]"});g.func=function(a){return"function "+m(a)+"() {}"};g.array=function(a,b){b=b||[];b.push(a);var c=[],e,
d;d=0<this.limitChildrenCount?Math.min(this.limitChildrenCount,a.length):a.length;for(e=0;e<d;++e)c.push(g(this,a[e],b));d<a.length&&c.push("[... "+(a.length-d)+" more elements]");return"["+c.join(", ")+"]"};g.object=function(c,b,p){b=b||[];b.push(c);p=p||0;var e=[],d=h.keys(c).sort(),f=3,r,z,m,u;u=0<this.limitChildrenCount?Math.min(this.limitChildrenCount,d.length):d.length;for(m=0;m<u;++m)r=d[m],z=c[r],z=l(z,b)?"[Circular]":g(this,z,b,p+2),z=(/\s/.test(r)?'"'+r+'"':r)+": "+z,f+=z.length,e.push(z);
b=(m=a(this,c))?"["+m+"] ":"";r="";m=0;for(c=p;m<c;++m)r+=" ";u<d.length&&e.push("[... "+(d.length-u)+" more elements]");return 80<f+p?b+"{\n  "+r+e.join(",\n  "+r)+"\n"+r+"}":b+"{ "+e.join(", ")+" }"};g.element=function(a){var b=a.tagName.toLowerCase(),c=a.attributes,e,d=[],f,r,g;r=0;for(g=c.length;r<g;++r)e=c.item(r),f=e.nodeName.toLowerCase().replace("html:",""),e=e.nodeValue,("contenteditable"!==f||"inherit"!==e)&&e&&d.push(f+'\x3d"'+e+'"');c="\x3c"+b+(0<d.length?" ":"");a=a.innerHTML;20<a.length&&
(a=a.substr(0,20)+"[...]");return(c+d.join(" ")+"\x3e"+a+"\x3c/"+b+"\x3e").replace(/ contentEditable="inherit"/,"")};f.prototype={functionName:m,configure:function(a){return new f(a)},constructorName:function(c){return a(this,c)},ascii:function(a,b,c){return g(this,a,b,c)}};return f.prototype});!function(n){if("object"==typeof exports&&"undefined"!=typeof module)module.exports=n();else if("function"==typeof h&&h.amd)h([],n);else{var m;"undefined"!=typeof window?m=window:"undefined"!=typeof global?
m=global:"undefined"!=typeof self&&(m=self);m.lolex=n()}}(function(){return function m(a,l,g){function f(c,b){if(!l[c]){if(!a[c]){var p="function"==typeof require&&require;if(!b&&p)return p(c,!0);if(d)return d(c,!0);p=Error("Cannot find module '"+c+"'");throw p.code="MODULE_NOT_FOUND",p;}p=l[c]={exports:{}};a[c][0].call(p.exports,function(b){var d=a[c][1][b];return f(d?d:b)},p,p.exports,m,a,l,g)}return l[c].exports}for(var d="function"==typeof require&&require,c=0;c<g.length;c++)f(g[c]);return f}({1:[function(h,
a,l){(function(a){(function(a){function d(b){if(!b)return 0;if("function"===typeof b.getTime)return b.getTime();if("number"===typeof b)return b;throw new TypeError("now should be milliseconds since UNIX epoch");}function c(b,a){for(var e in a)a.hasOwnProperty(e)&&(b[e]=a[e]);a.now?b.now=function(){return b.clock.now}:delete b.now;a.toSource?b.toSource=function(){return a.toSource()}:delete b.toSource;b.toString=function(){return a.toString()};b.prototype=a.prototype;b.parse=a.parse;b.UTC=a.UTC;b.prototype.toUTCString=
a.prototype.toUTCString;return b}function k(){function b(a,e,c,d,p,k,f){switch(arguments.length){case 0:return new v(b.clock.now);case 1:return new v(a);case 2:return new v(a,e);case 3:return new v(a,e,c);case 4:return new v(a,e,c,d);case 5:return new v(a,e,c,d,p);case 6:return new v(a,e,c,d,p,k);default:return new v(a,e,c,d,p,k,f)}}return c(b,v)}function b(b,a){if(void 0===a.func)throw Error("Callback must be provided to timer calls");b.timers||(b.timers={});a.id=B++;a.createdAt=b.now;a.callAt=b.now+
(a.delay||(b.duringTick?1:0));b.timers[a.id]=a;return q?{id:a.id,ref:u,unref:u}:a.id}function p(b,a){if(b.callAt<a.callAt)return-1;if(b.callAt>a.callAt)return 1;if(b.immediate&&!a.immediate)return-1;if(!b.immediate&&a.immediate)return 1;if(b.createdAt<a.createdAt)return-1;if(b.createdAt>a.createdAt)return 1;if(b.id<a.id)return-1;if(b.id>a.id)return 1}function e(b,a,e){b=b.timers;var c=null,d,k;for(d in b)b.hasOwnProperty(d)&&(k=(k=b[d])&&k.callAt>=a&&k.callAt<=e,!k||c&&1!==p(c,b[d])||(c=b[d]));return c}
function g(b,a){var e;"number"===typeof a.interval?b.timers[a.id].callAt+=a.interval:delete b.timers[a.id];try{"function"===typeof a.func?a.func.apply(null,a.args):eval(a.func)}catch(c){e=c}if(e)throw e;}function s(b){return b.immediate?"Immediate":"undefined"!==typeof b.interval?"Interval":"Timeout"}function r(b,a,e){if(a&&(b.timers||(b.timers=[]),"object"===typeof a&&(a=a.id),b.timers.hasOwnProperty(a))){var c=b.timers[a];if(s(c)===e)delete b.timers[a];else throw Error("Cannot clear timer: timer created with set"+
e+"() but cleared with clear"+s(c)+"()");}}function h(b,a,e){var d;e[a].hadOwnProperty=Object.prototype.hasOwnProperty.call(b,a);e["_"+a]=b[a];if("Date"===a)d=c(e[a],b[a]),b[a]=d;else for(d in b[a]=function(){return e[a].apply(e,arguments)},e[a])e[a].hasOwnProperty(d)&&(b[a][d]=e[a][d]);b[a].clock=e}function m(a){var c={now:d(a),timeouts:{},Date:k()};c.Date.clock=c;c.setTimeout=function(a,e){return b(c,{func:a,args:Array.prototype.slice.call(arguments,2),delay:e})};c.clearTimeout=function(b){return r(c,
b,"Timeout")};c.setInterval=function(a,e){return b(c,{func:a,args:Array.prototype.slice.call(arguments,2),delay:e,interval:e})};c.clearInterval=function(b){return r(c,b,"Interval")};c.setImmediate=function(a){return b(c,{func:a,args:Array.prototype.slice.call(arguments,1),immediate:!0})};c.clearImmediate=function(b){return r(c,b,"Immediate")};c.tick=function(b){var a;if("number"===typeof b)a=b;else if(b){a=b.split(":");var d=a.length,k=d,p=0,f;if(3<d||!/^(\d\d:){0,2}\d\d?$/.test(b))throw Error("tick only understands numbers, 'm:s' and 'h:m:s'. Each part must be two digits");
for(;k--;){f=parseInt(a[k],10);if(60<=f)throw Error("Invalid time "+b);p+=f*Math.pow(60,d-k-1)}a=1E3*p}else a=0;b=c.now;a=c.now+a;var d=c.now,k=e(c,b,a),r;c.duringTick=!0;for(var l;k&&b<=a;){if(c.timers[k.id]){b=c.now=k.callAt;try{r=c.now,g(c,k),r!==c.now&&(b+=c.now-r,a+=c.now-r,d+=c.now-r)}catch(s){l=l||s}}k=e(c,d,a);d=b}c.duringTick=!1;c.now=a;if(l)throw l;return c.now};c.next=function(){var b;b=c.timers;var a=null,e;for(e in b)b.hasOwnProperty(e)&&(a&&1!==p(a,b[e])||(a=b[e]));b=a;if(!b)return c.now;
c.duringTick=!0;try{return c.now=b.callAt,g(c,b),c.now}finally{c.duringTick=!1}};c.reset=function(){c.timers={}};c.setSystemTime=function(b){var a=d(b);b=a-c.now;c.now=a;for(var e in c.timers)c.timers.hasOwnProperty(e)&&(a=c.timers[e],a.createdAt+=b,a.callAt+=b)};return c}a.setTimeout=a.setTimeout;a.clearTimeout=a.clearTimeout;a.setInterval=a.setInterval;a.clearInterval=a.clearInterval;a.Date=a.Date;"setImmediate"in a&&(a.setImmediate=a.setImmediate,a.clearImmediate=a.clearImmediate);var u=function(){},
t=setTimeout(u,0),q="object"===typeof t;clearTimeout(t);var v=Date,B=1,C={setTimeout:setTimeout,clearTimeout:clearTimeout,setImmediate:a.setImmediate,clearImmediate:a.clearImmediate,setInterval:setInterval,clearInterval:clearInterval,Date:Date},L=Object.keys||function(b){var a=[],c;for(c in b)b.hasOwnProperty(c)&&a.push(c);return a};l.timers=C;l.createClock=m;l.install=function(b,c,e){"number"===typeof b&&(e=c,c=b,b=null);b||(b=a);var d=m(c);d.uninstall=function(){var a=b,c,e,k;e=0;for(k=d.methods.length;e<
k;e++)if(c=d.methods[e],a[c].hadOwnProperty)a[c]=d["_"+c];else try{delete a[c]}catch(p){}d.methods=[]};d.methods=e||[];0===d.methods.length&&(d.methods=L(C));c=0;for(e=d.methods.length;c<e;c++)h(b,d.methods[c],d);return d}})(a||this)}).call(this,"undefined"!==typeof global?global:"undefined"!==typeof self?self:"undefined"!==typeof window?window:{})},{}]},{},[1])(1)})})();var q=function(){var h;"undefined"!==typeof module&&module.exports&&"function"===typeof require?(h=require,module.exports=h("./sinon/util/core"),
h("./sinon/extend"),h("./sinon/walk"),h("./sinon/typeOf"),h("./sinon/times_in_words"),h("./sinon/spy"),h("./sinon/call"),h("./sinon/behavior"),h("./sinon/stub"),h("./sinon/mock"),h("./sinon/collection"),h("./sinon/assert"),h("./sinon/sandbox"),h("./sinon/test"),h("./sinon/test_case"),h("./sinon/match"),h("./sinon/format"),h("./sinon/log_error"),h=module.exports):h={};return h}();(function(h){function n(a){var d=!1;try{a.appendChild(g),d=g.parentNode===a}catch(b){return!1}finally{try{a.removeChild(g)}catch(p){}}return d}
function m(a,d){for(var b in d)f.call(a,b)||(a[b]=d[b])}function a(a){return"function"===typeof a&&"function"===typeof a.restore&&a.restore.sinon}function l(c){c.wrapMethod=function(a,b,p){function e(a){var c;"function"===typeof a||a&&a.constructor&&a.call&&a.apply?a.restore&&a.restore.sinon?c=new TypeError("Attempted to wrap "+b+" which is already wrapped"):a.calledBefore&&(c=new TypeError("Attempted to wrap "+b+" which is already "+(a.returns?"stubbed":"spied on"))):c=new TypeError("Attempted to wrap "+
typeof a+" property "+b+" as function");if(c)throw a&&a.stackTrace&&(c.stack+="\n--------------\n"+a.stackTrace),c;}if(!a)throw new TypeError("Should wrap property of object");if("function"!==typeof p&&"object"!==typeof p)throw new TypeError("Method wrapper should be a function or a property descriptor");var g,l,r=a.hasOwnProperty?a.hasOwnProperty(b):f.call(a,b);if(d){var h="function"===typeof p?{value:p}:p,n=c.getPropertyDescriptor(a,b);n?n.restore&&n.restore.sinon&&(g=new TypeError("Attempted to wrap "+
b+" which is already wrapped")):g=new TypeError("Attempted to wrap "+typeof l+" property "+b+" as function");if(g)throw n&&n.stackTrace&&(g.stack+="\n--------------\n"+n.stackTrace),g;var u=c.objectKeys(h);for(g=0;g<u.length;g++)l=n[u[g]],e(l);m(h,n);for(g=0;g<u.length;g++)m(h[u[g]],n[u[g]]);Object.defineProperty(a,b,h)}else l=a[b],e(l),a[b]=p,p.displayName=b;p.displayName=b;p.stackTrace=Error("Stack Trace for original").stack;p.restore=function(){if(r)d&&Object.defineProperty(a,b,n);else try{delete a[b]}catch(c){}a[b]===
p&&(a[b]=l)};p.restore.sinon=!0;d||m(p,l);return p};c.create=function(a){var b=function(){};b.prototype=a;return new b};c.deepEqual=function b(a,e){if(c.match&&c.match.isMatcher(a))return a.test(e);if("object"!==typeof a||"object"!==typeof e)return"number"===typeof a&&isNaN(a)&&"number"===typeof e&&isNaN(e)||a===e;if(g&&a&&1===a.nodeType&&n(a)||g&&e&&1===e.nodeType&&n(e))return a===e;if(a===e)return!0;if(null===a&&null!==e||null!==a&&null===e)return!1;if(a instanceof RegExp&&e instanceof RegExp)return a.source===
e.source&&a.global===e.global&&a.ignoreCase===e.ignoreCase&&a.multiline===e.multiline;var d=Object.prototype.toString.call(a);if(d!==Object.prototype.toString.call(e))return!1;if("[object Date]"===d)return a.valueOf()===e.valueOf();var f,r=0,l=0;if("[object Array]"===d&&a.length!==e.length)return!1;for(f in a)if(a.hasOwnProperty(f)&&(r+=1,!(f in e&&b(a[f],e[f]))))return!1;for(f in e)e.hasOwnProperty(f)&&(l+=1);return r===l};c.functionName=function(a){var c=a.displayName||a.name;c||(c=(a=a.toString().match(/function ([^\s\(]+)/))&&
a[1]);return c};c.functionToString=function(){if(this.getCall&&this.callCount)for(var a,c,e=this.callCount;e--;)for(c in a=this.getCall(e).thisValue,a)if(a[c]===this)return c;return this.displayName||"sinon fake"};c.objectKeys=function(a){if(a!==Object(a))throw new TypeError("sinon.objectKeys called on a non-object");var c=[],e;for(e in a)f.call(a,e)&&c.push(e);return c};c.getPropertyDescriptor=function(a,c){for(var e=a,d;e&&!(d=Object.getOwnPropertyDescriptor(e,c));)e=Object.getPrototypeOf(e);return d};
c.getConfig=function(a){var d={};a=a||{};var e=c.defaultConfig,f;for(f in e)e.hasOwnProperty(f)&&(d[f]=a.hasOwnProperty(f)?a[f]:e[f]);return d};c.defaultConfig={injectIntoThis:!0,injectInto:null,properties:"spy stub mock clock server requests".split(" "),useFakeTimers:!0,useFakeServer:!0};c.timesInWords=function(a){return 1===a&&"once"||2===a&&"twice"||3===a&&"thrice"||(a||0)+" times"};c.calledInOrder=function(a){for(var c=1,e=a.length;c<e;c++)if(!a[c-1].calledBefore(a[c])||!a[c].called)return!1;
return!0};c.orderByFirstCall=function(a){return a.sort(function(a,b){var c=a.getCall(0),d=b.getCall(0);return(c&&c.callId||-1)<(d&&d.callId||-1)?-1:1})};c.createStubInstance=function(a){if("function"!==typeof a)throw new TypeError("The constructor should be a function.");return c.stub(c.create(a.prototype))};c.restore=function(b){if(null!==b&&"object"===typeof b)for(var c in b)a(b[c])&&b[c].restore();else a(b)&&b.restore()};return c}var g="undefined"!==typeof document&&document.createElement("div"),
f=Object.prototype.hasOwnProperty,d="keys"in Object;"undefined"!==typeof module&&module.exports&&"function"===typeof require?l(module.exports):h&&l(h)})("object"===typeof q&&q);(function(h){function n(a){var l=function(){var a={constructor:function(){return"0"},toString:function(){return"1"},valueOf:function(){return"2"},toLocaleString:function(){return"3"},prototype:function(){return"4"},isPrototypeOf:function(){return"5"},propertyIsEnumerable:function(){return"6"},hasOwnProperty:function(){return"7"},
length:function(){return"8"},unique:function(){return"9"}},f=[],d;for(d in a)a.hasOwnProperty(d)&&f.push(a[d]());return"0123456789"!==f.join("")}();a.extend=function(a){var f=Array.prototype.slice.call(arguments,1),d,c,k;for(c=0;c<f.length;c++){d=f[c];for(k in d)d.hasOwnProperty(k)&&(a[k]=d[k]);l&&d.hasOwnProperty("toString")&&d.toString!==a.toString&&(a.toString=d.toString)}return a};return a.extend}function m(a,l,g){a=a("./util/core");g.exports=n(a)}"undefined"!==typeof module&&module.exports&&
"function"===typeof require?m(require,module.exports,module):h&&n(h)})("object"===typeof q&&q);(function(h){function n(a){a.timesInWords=function(a){switch(a){case 1:return"once";case 2:return"twice";case 3:return"thrice";default:return(a||0)+" times"}};return a.timesInWords}function m(a,l,g){a=a("./util/core");g.exports=n(a)}"undefined"!==typeof module&&module.exports&&"function"===typeof require?m(require,module.exports,module):h&&n(h)})("object"===typeof q&&q);(function(h){function n(a){a.typeOf=
function(a){if(null===a)return"null";if(void 0===a)return"undefined";a=Object.prototype.toString.call(a);return a.substring(8,a.length-1).toLowerCase()};return a.typeOf}function m(a,l,g){a=a("./util/core");g.exports=n(a)}"undefined"!==typeof module&&module.exports&&"function"===typeof require?m(require,module.exports,module):h&&n(h)})("object"===typeof q&&q);(function(h){function n(a){function l(b,c,e){b=a.typeOf(b);if(b!==c)throw new TypeError("Expected type of "+e+" to be "+c+", but was "+b);}function g(a){return k.isPrototypeOf(a)}
function f(b,c){if(null===c||void 0===c)return!1;for(var e in b)if(b.hasOwnProperty(e)){var d=b[e],k=c[e];if(g(d)){if(!d.test(k))return!1}else if("object"===a.typeOf(d)){if(!f(d,k))return!1}else if(!a.deepEqual(d,k))return!1}return!0}function d(b,c){var e=a.create(k);switch(a.typeOf(b)){case "object":if("function"===typeof b.test)return e.test=function(a){return!0===b.test(a)},e.message="match("+a.functionName(b.test)+")",e;var d=[],g;for(g in b)b.hasOwnProperty(g)&&d.push(g+": "+b[g]);e.test=function(a){return f(b,
a)};e.message="match("+d.join(", ")+")";break;case "number":e.test=function(a){return b==a};break;case "string":e.test=function(a){return"string"!==typeof a?!1:-1!==a.indexOf(b)};e.message='match("'+b+'")';break;case "regexp":e.test=function(a){return"string"!==typeof a?!1:b.test(a)};break;case "function":e.test=b;e.message=c?c:"match("+a.functionName(b)+")";break;default:e.test=function(c){return a.deepEqual(b,c)}}e.message||(e.message="match("+b+")");return e}function c(b,c){return function(e,k){l(e,
"string","property");var f=1===arguments.length,g=c+'("'+e+'"';f||(g+=", "+k);return d(function(c){return void 0!==c&&null!==c&&b(c,e)?f||a.deepEqual(k,c[e]):!1},g+")")}}var k={toString:function(){return this.message},or:function(b){if(arguments.length)g(b)||(b=d(b));else throw new TypeError("Matcher expected");var c=this,e=a.create(k);e.test=function(a){return c.test(a)||b.test(a)};e.message=c.message+".or("+b.message+")";return e},and:function(b){if(arguments.length)g(b)||(b=d(b));else throw new TypeError("Matcher expected");
var c=this,e=a.create(k);e.test=function(a){return c.test(a)&&b.test(a)};e.message=c.message+".and("+b.message+")";return e}};d.isMatcher=g;d.any=d(function(){return!0},"any");d.defined=d(function(a){return null!==a&&void 0!==a},"defined");d.truthy=d(function(a){return!!a},"truthy");d.falsy=d(function(a){return!a},"falsy");d.same=function(a){return d(function(c){return a===c},"same("+a+")")};d.typeOf=function(b){l(b,"string","type");return d(function(c){return a.typeOf(c)===b},'typeOf("'+b+'")')};
d.instanceOf=function(b){l(b,"function","type");return d(function(a){return a instanceof b},"instanceOf("+a.functionName(b)+")")};d.has=c(function(a,c){return"object"===typeof a?c in a:void 0!==a[c]},"has");d.hasOwn=c(function(a,c){return a.hasOwnProperty(c)},"hasOwn");d.bool=d.typeOf("boolean");d.number=d.typeOf("number");d.string=d.typeOf("string");d.object=d.typeOf("object");d.func=d.typeOf("function");d.array=d.typeOf("array");d.regexp=d.typeOf("regexp");d.date=d.typeOf("date");return a.match=
d}function m(a,l,g){l=a("./util/core");a("./typeOf");g.exports=n(l)}"undefined"!==typeof module&&module.exports&&"function"===typeof require?m(require,module.exports,module):h&&n(h)})("object"===typeof q&&q);(function(h,n){function m(a){function g(a){return""+a}function f(){var a=n.configure({quoteStrings:!1,limitChildrenCount:250});return function(){return a.ascii.apply(a,arguments)}}function d(){function a(b){return"object"===typeof b&&b.toString===Object.prototype.toString?c.inspect(b):b}try{var c=
require("util")}catch(e){}return c?a:g}var c="undefined"!==typeof module&&module.exports&&"function"===typeof require;if(c)try{n=require("formatio")}catch(k){}c=n?f():c?d():g;a.format=c;return a.format}function a(a,g,f){a=a("./util/core");f.exports=m(a)}"undefined"!==typeof module&&module.exports&&"function"===typeof require?a(require,module.exports,module):h&&m(h)})("object"===typeof q&&q,"object"===typeof w&&w);(function(h){function n(l){function g(c,d,b){c=l.functionName(c)+d;b.length&&(c+=" Received ["+
a.call(b).join(", ")+"]");throw Error(c);}function f(a,k,b,f,e,g,s){if("number"!==typeof g)throw new TypeError("Call id is not a number");var r=l.create(d);r.proxy=a;r.thisValue=k;r.args=b;r.returnValue=f;r.exception=e;r.callId=g;r.stack=s;return r}var d={calledOn:function(a){return l.match&&l.match.isMatcher(a)?a.test(this.thisValue):this.thisValue===a},calledWith:function(){var a=arguments.length;if(a>this.args.length)return!1;for(var d=0;d<a;d+=1)if(!l.deepEqual(arguments[d],this.args[d]))return!1;
return!0},calledWithMatch:function(){var a=arguments.length;if(a>this.args.length)return!1;for(var d=0;d<a;d+=1){var b=this.args[d],f=arguments[d];if(!l.match||!l.match(f).test(b))return!1}return!0},calledWithExactly:function(){return arguments.length===this.args.length&&this.calledWith.apply(this,arguments)},notCalledWith:function(){return!this.calledWith.apply(this,arguments)},notCalledWithMatch:function(){return!this.calledWithMatch.apply(this,arguments)},returned:function(a){return l.deepEqual(a,
this.returnValue)},threw:function(a){return"undefined"!==typeof a&&this.exception?this.exception===a||this.exception.name===a:!!this.exception},calledWithNew:function(){return this.proxy.prototype&&this.thisValue instanceof this.proxy},calledBefore:function(a){return this.callId<a.callId},calledAfter:function(a){return this.callId>a.callId},callArg:function(a){this.args[a]()},callArgOn:function(a,d){this.args[a].apply(d)},callArgWith:function(c){this.callArgOnWith.apply(this,[c,null].concat(a.call(arguments,
1)))},callArgOnWith:function(c,d){var b=a.call(arguments,2);this.args[c].apply(d,b)},yield:function(){this.yieldOn.apply(this,[null].concat(a.call(arguments,0)))},yieldOn:function(c){for(var d=this.args,b=0,f=d.length;b<f;++b)if("function"===typeof d[b]){d[b].apply(c,a.call(arguments,1));return}g(this.proxy," cannot yield since no callback was passed.",d)},yieldTo:function(c){this.yieldToOn.apply(this,[c,null].concat(a.call(arguments,1)))},yieldToOn:function(c,d){for(var b=this.args,f=0,e=b.length;f<
e;++f)if(b[f]&&"function"===typeof b[f][c]){b[f][c].apply(d,a.call(arguments,2));return}g(this.proxy," cannot yield to '"+c+"' since no callback was passed.",b)},getStackFrames:function(){return this.stack&&this.stack.split("\n").slice(3)},toString:function(){var a=this.proxy?this.proxy.toString()+"(":"",d=[];if(!this.args)return":(";for(var b=0,f=this.args.length;b<f;++b)d.push(l.format(this.args[b]));a=a+d.join(", ")+")";"undefined"!==typeof this.returnValue&&(a+=" \x3d\x3e "+l.format(this.returnValue));
this.exception&&(a+=" !"+this.exception.name,this.exception.message&&(a+="("+this.exception.message+")"));this.stack&&(a+=this.getStackFrames()[0].replace(/^\s*(?:at\s+|@)?/," at "));return a}};d.invokeCallback=d.yield;f.toString=d.toString;return l.spyCall=f}function m(a,g,f){g=a("./util/core");a("./match");a("./format");f.exports=n(g)}var a=Array.prototype.slice;"undefined"!==typeof module&&module.exports&&"function"===typeof require?m(require,module.exports,module):h&&n(h)})("object"===typeof q&&
q);(function(h){function n(a){function l(b,c,e){if(!c&&"function"===typeof b)return l.create(b);if(!b&&!c)return l.create(function(){});if(e){for(var d=a.getPropertyDescriptor(b,c),f=0;f<e.length;f++)d[e[f]]=l.create(d[e[f]]);return a.wrapMethod(b,c,d)}return a.wrapMethod(b,c,l.create(b[c]))}function g(a,b,c){if(a)for(var e=0,d=a.length;e<d;e++)if(a[e].matches(b,c))return a[e]}function f(){this.called=!0;this.callCount+=1;this.notCalled=!1;this.calledOnce=1===this.callCount;this.calledTwice=2===this.callCount;
this.calledThrice=3===this.callCount}function d(){this.firstCall=this.getCall(0);this.secondCall=this.getCall(1);this.thirdCall=this.getCall(2);this.lastCall=this.getCall(this.callCount-1)}function c(a,b){var c;b?eval("p \x3d (function proxy("+"a,b,c,d,e,f,g,h,i,j,k,l".substring(0,2*b-1)+") { return p.invoke(func, this, slice.call(arguments)); });"):c=function(){return c.invoke(a,this,p.call(arguments))};c.isSinonProxy=!0;return c}function k(a,b,c,e){s[a]=function(){if(!this.called)return e?e.apply(this,
arguments):!1;for(var d,f=0,k=0,g=this.callCount;k<g;k+=1)if(d=this.getCall(k),d[c||a].apply(d,arguments)&&(f+=1,b))return!0;return f===this.callCount}}var b=Array.prototype.push,p=Array.prototype.slice,e=0,h=0,s={reset:function(){if(this.invoking){var a=Error("Cannot reset Sinon function while invoking it. Move the call to .reset outside of the callback.");a.name="InvalidResetException";throw a;}this.called=!1;this.notCalled=!0;this.calledThrice=this.calledTwice=this.calledOnce=!1;this.callCount=
0;this.lastCall=this.thirdCall=this.secondCall=this.firstCall=null;this.args=[];this.returnValues=[];this.thisValues=[];this.exceptions=[];this.callIds=[];this.stacks=[];if(this.fakes)for(a=0;a<this.fakes.length;a++)this.fakes[a].reset();return this},create:function(b,e){var d;"function"!==typeof b?b=function(){}:d=a.functionName(b);e||(e=b.length);var f=c(b,e);a.extend(f,l);delete f.create;a.extend(f,b);f.reset();f.prototype=b.prototype;f.displayName=d||"spy";f.toString=a.functionToString;f.instantiateFake=
a.spy.create;f.id="spy#"+h++;return f},invoke:function(a,c,k){var l=g(this.fakes,k),p,s;f.call(this);b.call(this.thisValues,c);b.call(this.args,k);b.call(this.callIds,e++);d.call(this);try{this.invoking=!0,s=l?l.invoke(a,c,k):(this.func||a).apply(c,k),this.getCall(this.callCount-1).calledWithNew()&&"object"!==typeof s&&(s=c)}catch(h){p=h}finally{delete this.invoking}b.call(this.exceptions,p);b.call(this.returnValues,s);b.call(this.stacks,Error().stack);d.call(this);if(void 0!==p)throw p;return s},
named:function(a){this.displayName=a;return this},getCall:function(b){return 0>b||b>=this.callCount?null:a.spyCall(this,this.thisValues[b],this.args[b],this.returnValues[b],this.exceptions[b],this.callIds[b],this.stacks[b])},getCalls:function(){var a=[],b;for(b=0;b<this.callCount;b++)a.push(this.getCall(b));return a},calledBefore:function(a){return this.called?a.called?this.callIds[0]<a.callIds[a.callIds.length-1]:!0:!1},calledAfter:function(a){return this.called&&a.called?this.callIds[this.callCount-
1]>a.callIds[a.callCount-1]:!1},withArgs:function(){var a=p.call(arguments);if(this.fakes){var c=g(this.fakes,a,!0);if(c)return c}else this.fakes=[];var e=this,c=this.instantiateFake();c.matchingAguments=a;c.parent=this;b.call(this.fakes,c);c.withArgs=function(){return e.withArgs.apply(e,arguments)};for(a=0;a<this.args.length;a++)c.matches(this.args[a])&&(f.call(c),b.call(c.thisValues,this.thisValues[a]),b.call(c.args,this.args[a]),b.call(c.returnValues,this.returnValues[a]),b.call(c.exceptions,this.exceptions[a]),
b.call(c.callIds,this.callIds[a]));d.call(c);return c},matches:function(b,c){var e=this.matchingAguments;if(e.length<=b.length&&a.deepEqual(e,b.slice(0,e.length)))return!c||e.length===b.length},printf:function(b){var c=this,e=p.call(arguments,1),d;return(b||"").replace(/%(.)/g,function(b,f){d=s.formatters[f];return"function"===typeof d?d.call(null,c,e):isNaN(parseInt(f,10))?"%"+f:a.format(e[f-1])})}};k("calledOn",!0);k("alwaysCalledOn",!1,"calledOn");k("calledWith",!0);k("calledWithMatch",!0);k("alwaysCalledWith",
!1,"calledWith");k("alwaysCalledWithMatch",!1,"calledWithMatch");k("calledWithExactly",!0);k("alwaysCalledWithExactly",!1,"calledWithExactly");k("neverCalledWith",!1,"notCalledWith",function(){return!0});k("neverCalledWithMatch",!1,"notCalledWithMatch",function(){return!0});k("threw",!0);k("alwaysThrew",!1,"threw");k("returned",!0);k("alwaysReturned",!1,"returned");k("calledWithNew",!0);k("alwaysCalledWithNew",!1,"calledWithNew");k("callArg",!1,"callArgWith",function(){throw Error(this.toString()+
" cannot call arg since it was not yet invoked.");});s.callArgWith=s.callArg;k("callArgOn",!1,"callArgOnWith",function(){throw Error(this.toString()+" cannot call arg since it was not yet invoked.");});s.callArgOnWith=s.callArgOn;k("yield",!1,"yield",function(){throw Error(this.toString()+" cannot yield since it was not yet invoked.");});s.invokeCallback=s.yield;k("yieldOn",!1,"yieldOn",function(){throw Error(this.toString()+" cannot yield since it was not yet invoked.");});k("yieldTo",!1,"yieldTo",
function(a){throw Error(this.toString()+" cannot yield to '"+a+"' since it was not yet invoked.");});k("yieldToOn",!1,"yieldToOn",function(a){throw Error(this.toString()+" cannot yield to '"+a+"' since it was not yet invoked.");});s.formatters={c:function(b){return a.timesInWords(b.callCount)},n:function(a){return a.toString()},C:function(a){for(var c=[],e=0,d=a.callCount;e<d;++e){var f="    "+a.getCall(e).toString();/\n/.test(c[e-1])&&(f="\n"+f);b.call(c,f)}return 0<c.length?"\n"+c.join("\n"):""},
t:function(c){for(var e=[],d=0,f=c.callCount;d<f;++d)b.call(e,a.format(c.thisValues[d]));return e.join(", ")},"*":function(c,e){for(var d=[],f=0,k=e.length;f<k;++f)b.call(d,a.format(e[f]));return d.join(", ")}};a.extend(l,s);l.spyCall=a.spyCall;return a.spy=l}function m(a,l,g){l=a("./util/core");a("./call");a("./extend");a("./times_in_words");a("./format");g.exports=n(l)}"undefined"!==typeof module&&module.exports&&"function"===typeof require?m(require,module.exports,module):h&&n(h)})("object"===
typeof q&&q);(function(h){function n(a,d){"string"===typeof a?(this.exception=Error(d||""),this.exception.name=a):this.exception=a?a:Error("Error");return this}function m(a,d){var b=a.callArgAt;if(0<=b)return d[b];var f;-1===b&&(f=d);-2===b&&(f=g.call(d).reverse());for(var b=a.callArgProp,e=0,l=f.length;e<l;++e){if(!b&&"function"===typeof f[e])return f[e];if(b&&f[e]&&"function"===typeof f[e][b])return f[e][b]}return null}function a(a){function k(b,e,d){return 0>b.callArgAt?(b=b.callArgProp?a.functionName(b.stub)+
" expected to yield to '"+b.callArgProp+"', but no object with such a property was passed.":a.functionName(b.stub)+" expected to yield, but no callback was passed.",0<d.length&&(b+=" Received ["+f.call(d,", ")+"]"),b):"argument at index "+b.callArgAt+" is not a function: "+e}function b(a,b){if("number"===typeof a.callArgAt){var c=m(a,b);if("function"!==typeof c)throw new TypeError(k(a,c,b));a.callbackAsync?d(function(){c.apply(a.callbackContext,a.callbackArguments)}):c.apply(a.callbackContext,a.callbackArguments)}}
function l(a){return function(){var b=this[a].apply(this,arguments);this.callbackAsync=!0;return b}}var e={create:function(b){var e=a.extend({},a.behavior);delete e.create;e.stub=b;return e},isPresent:function(){return"number"===typeof this.callArgAt||this.exception||"number"===typeof this.returnArgAt||this.returnThis||this.returnValueDefined},invoke:function(a,c){b(this,c);if(this.exception)throw this.exception;return"number"===typeof this.returnArgAt?c[this.returnArgAt]:this.returnThis?a:this.returnValue},
onCall:function(a){return this.stub.onCall(a)},onFirstCall:function(){return this.stub.onFirstCall()},onSecondCall:function(){return this.stub.onSecondCall()},onThirdCall:function(){return this.stub.onThirdCall()},withArgs:function(){throw Error('Defining a stub by invoking "stub.onCall(...).withArgs(...)" is not supported. Use "stub.withArgs(...).onCall(...)" to define sequential behavior for calls with certain arguments.');},callsArg:function(a){if("number"!==typeof a)throw new TypeError("argument index is not number");
this.callArgAt=a;this.callbackArguments=[];this.callArgProp=this.callbackContext=void 0;this.callbackAsync=!1;return this},callsArgOn:function(a,b){if("number"!==typeof a)throw new TypeError("argument index is not number");if("object"!==typeof b)throw new TypeError("argument context is not an object");this.callArgAt=a;this.callbackArguments=[];this.callbackContext=b;this.callArgProp=void 0;this.callbackAsync=!1;return this},callsArgWith:function(a){if("number"!==typeof a)throw new TypeError("argument index is not number");
this.callArgAt=a;this.callbackArguments=g.call(arguments,1);this.callArgProp=this.callbackContext=void 0;this.callbackAsync=!1;return this},callsArgOnWith:function(a,b){if("number"!==typeof a)throw new TypeError("argument index is not number");if("object"!==typeof b)throw new TypeError("argument context is not an object");this.callArgAt=a;this.callbackArguments=g.call(arguments,2);this.callbackContext=b;this.callArgProp=void 0;this.callbackAsync=!1;return this},yields:function(){this.callArgAt=-1;
this.callbackArguments=g.call(arguments,0);this.callArgProp=this.callbackContext=void 0;this.callbackAsync=!1;return this},yieldsRight:function(){this.callArgAt=-2;this.callbackArguments=g.call(arguments,0);this.callArgProp=this.callbackContext=void 0;this.callbackAsync=!1;return this},yieldsOn:function(a){if("object"!==typeof a)throw new TypeError("argument context is not an object");this.callArgAt=-1;this.callbackArguments=g.call(arguments,1);this.callbackContext=a;this.callArgProp=void 0;this.callbackAsync=
!1;return this},yieldsTo:function(a){this.callArgAt=-1;this.callbackArguments=g.call(arguments,1);this.callbackContext=void 0;this.callArgProp=a;this.callbackAsync=!1;return this},yieldsToOn:function(a,b){if("object"!==typeof b)throw new TypeError("argument context is not an object");this.callArgAt=-1;this.callbackArguments=g.call(arguments,2);this.callbackContext=b;this.callArgProp=a;this.callbackAsync=!1;return this},"throws":n,throwsException:n,returns:function(a){this.returnValue=a;this.returnValueDefined=
!0;this.exception=void 0;return this},returnsArg:function(a){if("number"!==typeof a)throw new TypeError("argument index is not number");this.returnArgAt=a;return this},returnsThis:function(){this.returnThis=!0;return this}},h;for(h in e)e.hasOwnProperty(h)&&h.match(/^(callsArg|yields)/)&&!h.match(/Async/)&&(e[h+"Async"]=l(h));return a.behavior=e}function l(c,d,b){d=c("./util/core");c("./extend");b.exports=a(d)}var g=Array.prototype.slice,f=Array.prototype.join,d=function(){return"object"===typeof process&&
"function"===typeof process.nextTick?process.nextTick:"function"===typeof setImmediate?setImmediate:function(a){setTimeout(a,0)}}();"undefined"!==typeof module&&module.exports&&"function"===typeof require?l(require,module.exports,module):h&&a(h)})("object"===typeof q&&q);(function(h){function n(a){function l(a,f,d,c,k){var b;if("function"!==typeof Object.getOwnPropertyNames)for(b in a)f.call(d,a[b],b,a);else Object.getOwnPropertyNames(a).forEach(function(b){if(!k[b]){k[b]=!0;var e="function"===typeof Object.getOwnPropertyDescriptor(a,
b).get?c:a;f.call(d,e[b],b,e)}}),(b=Object.getPrototypeOf(a))&&l(b,f,d,c,k)}a.walk=function(a,f,d){return l(a,f,d,a,{})};return a.walk}function m(a,l,g){a=a("./util/core");g.exports=n(a)}"undefined"!==typeof module&&module.exports&&"function"===typeof require?m(require,module.exports,module):h&&n(h)})("object"===typeof q&&q);(function(h){function n(a){function l(b,c,e){if(e&&"function"!==typeof e&&"object"!==typeof e)throw new TypeError("Custom stub should be a function or a property descriptor");
if(e)if("function"===typeof e)e=a.spy&&a.spy.create?a.spy.create(e):e;else{if(a.spy&&a.spy.create)for(var d=a.objectKeys(e),f=0;f<d.length;f++)e[d[f]]=a.spy.create(e[d[f]])}else e=0,"object"===typeof b&&"function"===typeof b[c]&&(e=b[c].length),e=l.create(e);return b||"undefined"!==typeof c?"undefined"===typeof c&&"object"===typeof b?(a.walk(b||{},function(c,e,d){d!==Object.prototype&&"constructor"!==e&&"function"===typeof a.getPropertyDescriptor(d,e).value&&l(b,e)}),b):a.wrapMethod(b,c,e):a.stub.create()}
function g(b){var c=b.behaviors[b.callCount-1];return c&&c.isPresent()?c:b.defaultBehavior||b.parent&&g(b.parent)||a.behavior.create(b)}function f(b){return function(){this.defaultBehavior=this.defaultBehavior||a.behavior.create(this);this.defaultBehavior[b].apply(this.defaultBehavior,arguments);return this}}var d=0,c={create:function(b){var c=function(){return g(c).invoke(this,arguments)};c.id="stub#"+d++;var e=c,c=a.spy.create(c,b);c.func=e;a.extend(c,l);c.instantiateFake=a.stub.create;c.displayName=
"stub";c.toString=a.functionToString;c.defaultBehavior=null;c.behaviors=[];return c},resetBehavior:function(){var a;this.defaultBehavior=null;this.behaviors=[];delete this.returnValue;delete this.returnArgAt;this.returnThis=!1;if(this.fakes)for(a=0;a<this.fakes.length;a++)this.fakes[a].resetBehavior()},onCall:function(b){this.behaviors[b]||(this.behaviors[b]=a.behavior.create(this));return this.behaviors[b]},onFirstCall:function(){return this.onCall(0)},onSecondCall:function(){return this.onCall(1)},
onThirdCall:function(){return this.onCall(2)}},k;for(k in a.behavior)a.behavior.hasOwnProperty(k)&&!c.hasOwnProperty(k)&&"create"!==k&&"withArgs"!==k&&"invoke"!==k&&(c[k]=f(k));a.extend(l,c);return a.stub=l}function m(a,l,g){l=a("./util/core");a("./behavior");a("./spy");a("./extend");g.exports=n(l)}"undefined"!==typeof module&&module.exports&&"function"===typeof require?m(require,module.exports,module):h&&n(h)})("object"===typeof q&&q);(function(h){function n(a){function l(b){return b?l.create(b):
a.expectation.create("Anonymous mock")}function g(a,b){if(a)for(var c=0,d=a.length;c<d;c+=1)b(a[c])}function f(a){return"number"!==typeof a.maxCalls?!1:a.callCount===a.maxCalls}function d(a,b){return k&&k.isMatcher(a)&&a.test(b)||!0}var c=[].push,k=a.match;a.extend(l,{create:function(b){if(!b)throw new TypeError("object is null");var c=a.extend({},l);c.object=b;delete c.create;return c},expects:function(b){if(!b)throw new TypeError("method is falsy");this.expectations||(this.expectations={},this.proxies=
[]);if(!this.expectations[b]){this.expectations[b]=[];var d=this;a.wrapMethod(this.object,b,function(){return d.invokeMethod(b,this,arguments)});c.call(this.proxies,b)}var f=a.expectation.create(b);c.call(this.expectations[b],f);return f},restore:function(){var a=this.object;g(this.proxies,function(b){"function"===typeof a[b].restore&&a[b].restore()})},verify:function(){var b=this.expectations||{},d=[],f=[];g(this.proxies,function(a){g(b[a],function(a){a.met()?c.call(f,a.toString()):c.call(d,a.toString())})});
this.restore();0<d.length?a.expectation.fail(d.concat(f).join("\n")):0<f.length&&a.expectation.pass(d.concat(f).join("\n"));return!0},invokeMethod:function(b,d,f){var k=this.expectations&&this.expectations[b]?this.expectations[b]:[],g=[],l=f||[],h,p;for(h=0;h<k.length;h+=1){var m;a:{m=k[h].expectedArguments||[];var n=l;if(k[h].expectsExactArgCount&&m.length!==n.length)m=!1;else{for(var q=0,C=m.length;q<C;q++)if(!a.deepEqual(m[q],n[q])){m=!1;break a}m=!0}}m&&g.push(k[h])}for(h=0;h<g.length;h+=1)if(!g[h].met()&&
g[h].allowsCall(d,f))return g[h].apply(d,f);l=[];for(h=m=0;h<g.length;h+=1)g[h].allowsCall(d,f)?p=p||g[h]:m+=1;if(p&&0===m)return p.apply(d,f);for(h=0;h<k.length;h+=1)c.call(l,"    "+k[h].toString());l.unshift("Unexpected call: "+a.spyCall.toString.call({proxy:b,args:f}));a.expectation.fail(l.join("\n"))}});var b=a.timesInWords,h=Array.prototype.slice;a.expectation={minCalls:1,maxCalls:1,create:function(b){var c=a.extend(a.stub.create(),a.expectation);delete c.create;c.method=b;return c},invoke:function(b,
c,d){this.verifyCallAllowed(c,d);return a.spy.invoke.apply(this,arguments)},atLeast:function(a){if("number"!==typeof a)throw new TypeError("'"+a+"' is not number");this.limitsSet||(this.maxCalls=null,this.limitsSet=!0);this.minCalls=a;return this},atMost:function(a){if("number"!==typeof a)throw new TypeError("'"+a+"' is not number");this.limitsSet||(this.minCalls=null,this.limitsSet=!0);this.maxCalls=a;return this},never:function(){return this.exactly(0)},once:function(){return this.exactly(1)},twice:function(){return this.exactly(2)},
thrice:function(){return this.exactly(3)},exactly:function(a){if("number"!==typeof a)throw new TypeError("'"+a+"' is not a number");this.atLeast(a);return this.atMost(a)},met:function(){var a;if(a=!this.failed)a="number"!==typeof this.minCalls||this.callCount>=this.minCalls;return a},verifyCallAllowed:function(c,k){f(this)&&(this.failed=!0,a.expectation.fail(this.method+" already called "+b(this.maxCalls)));"expectedThis"in this&&this.expectedThis!==c&&a.expectation.fail(this.method+" called with "+
c+" as thisValue, expected "+this.expectedThis);if("expectedArguments"in this){k||a.expectation.fail(this.method+" received no arguments, expected "+a.format(this.expectedArguments));k.length<this.expectedArguments.length&&a.expectation.fail(this.method+" received too few arguments ("+a.format(k)+"), expected "+a.format(this.expectedArguments));this.expectsExactArgCount&&k.length!==this.expectedArguments.length&&a.expectation.fail(this.method+" received too many arguments ("+a.format(k)+"), expected "+
a.format(this.expectedArguments));for(var g=0,l=this.expectedArguments.length;g<l;g+=1)d(this.expectedArguments[g],k[g])||a.expectation.fail(this.method+" received wrong arguments "+a.format(k)+", didn't match "+this.expectedArguments.toString()),a.deepEqual(this.expectedArguments[g],k[g])||a.expectation.fail(this.method+" received wrong arguments "+a.format(k)+", expected "+a.format(this.expectedArguments))}},allowsCall:function(b,c){if(this.met()&&f(this)||"expectedThis"in this&&this.expectedThis!==
b)return!1;if(!("expectedArguments"in this))return!0;c=c||[];if(c.length<this.expectedArguments.length||this.expectsExactArgCount&&c.length!==this.expectedArguments.length)return!1;for(var k=0,g=this.expectedArguments.length;k<g;k+=1)if(!d(this.expectedArguments[k],c[k])||!a.deepEqual(this.expectedArguments[k],c[k]))return!1;return!0},withArgs:function(){this.expectedArguments=h.call(arguments);return this},withExactArgs:function(){this.withArgs.apply(this,arguments);this.expectsExactArgCount=!0;
return this},on:function(a){this.expectedThis=a;return this},toString:function(){var d=(this.expectedArguments||[]).slice();this.expectsExactArgCount||c.call(d,"[...]");var d=a.spyCall.toString.call({proxy:this.method||"anonymous mock expectation",args:d}).replace(", [...","[, ...")+" ",f;f=this.minCalls;var k=this.maxCalls;if("number"===typeof f&&"number"===typeof k){var g=b(f);f!==k&&(g="at least "+g+" and at most "+b(k));f=g}else f="number"===typeof f?"at least "+b(f):"at most "+b(k);d+=f;if(this.met())return"Expectation met: "+
d;f=this.callCount;f=0===f?"never called":"called "+b(f);return"Expected "+d+" ("+f+")"},verify:function(){this.met()?a.expectation.pass(this.toString()):a.expectation.fail(this.toString());return!0},pass:function(b){a.assert.pass(b)},fail:function(a){a=Error(a);a.name="ExpectationError";throw a;}};return a.mock=l}function m(a,l,g){l=a("./util/core");a("./times_in_words");a("./call");a("./extend");a("./match");a("./spy");a("./stub");a("./format");g.exports=n(l)}"undefined"!==typeof module&&module.exports&&
"function"===typeof require?m(require,module.exports,module):h&&n(h)})("object"===typeof q&&q);(function(h){function n(a){a.fakes||(a.fakes=[]);return a.fakes}function m(a,c){for(var f=n(a),b=0,g=f.length;b<g;b+=1)if("function"===typeof f[b][c])f[b][c]()}function a(a){var c={verify:function(){m(this,"verify")},restore:function(){m(this,"restore");for(var a=n(this);0<a.length;)a.splice(0,1)},reset:function(){m(this,"reset")},verifyAndRestore:function(){var a;try{this.verify()}catch(b){a=b}this.restore();
if(a)throw a;},add:function(a){g.call(n(this),a);return a},spy:function(){return this.add(a.spy.apply(a,arguments))},stub:function(c,b,g){if(b){var e=c[b];if("function"!==typeof e){if(!f.call(c,b))throw new TypeError("Cannot stub non-existent own property "+b);c[b]=g;return this.add({restore:function(){c[b]=e}})}}if(!b&&c&&"object"===typeof c){var l=a.stub.apply(a,arguments),h;for(h in l)"function"===typeof l[h]&&this.add(l[h]);return l}return this.add(a.stub.apply(a,arguments))},mock:function(){return this.add(a.mock.apply(a,
arguments))},inject:function(a){var b=this;a.spy=function(){return b.spy.apply(b,arguments)};a.stub=function(){return b.stub.apply(b,arguments)};a.mock=function(){return b.mock.apply(b,arguments)};return a}};return a.collection=c}function l(d,c,f){c=d("./util/core");d("./mock");d("./spy");d("./stub");f.exports=a(c)}var g=[].push,f=Object.prototype.hasOwnProperty;"undefined"!==typeof module&&module.exports&&"function"===typeof require?l(require,module.exports,module):h&&a(h)})("object"===typeof q&&
q);(function(){function h(h,a){var l="undefined"!==typeof K?K:a;h.useFakeTimers=function(){var a,f=Array.prototype.slice.call(arguments);a="string"===typeof f[0]?0:f.shift();a=l.install(a||0,f);a.restore=a.uninstall;return a};h.clock={create:function(a){return l.createClock(a)}};h.timers={setTimeout:setTimeout,clearTimeout:clearTimeout,setImmediate:"undefined"!==typeof setImmediate?setImmediate:void 0,clearImmediate:"undefined"!==typeof clearImmediate?clearImmediate:void 0,setInterval:setInterval,
clearInterval:clearInterval,Date:Date}}function n(m,a,l,g){m=m("./core");h(m,g);l.exports=m}"undefined"!==typeof module&&module.exports&&"function"===typeof require?n(require,module.exports,module,require("lolex")):h(q)})();"undefined"===typeof q&&(this.sinon={});(function(){function h(a){a.Event=function(a,g,f,d){this.initEvent(a,g,f,d)};a.Event.prototype={initEvent:function(a,g,f,d){this.type=a;this.bubbles=g;this.cancelable=f;this.target=d},stopPropagation:function(){},preventDefault:function(){this.defaultPrevented=
!0}};a.ProgressEvent=function(a,g,f){this.initEvent(a,!1,!1,f);this.loaded=g.loaded||null;this.total=g.total||null;this.lengthComputable=!!g.total};a.ProgressEvent.prototype=new a.Event;a.ProgressEvent.prototype.constructor=a.ProgressEvent;a.CustomEvent=function(a,g,f){this.initEvent(a,!1,!1,f);this.detail=g.detail||null};a.CustomEvent.prototype=new a.Event;a.CustomEvent.prototype.constructor=a.CustomEvent;a.EventTarget={addEventListener:function(a,g){this.eventListeners=this.eventListeners||{};this.eventListeners[a]=
this.eventListeners[a]||[];m.call(this.eventListeners[a],g)},removeEventListener:function(a,g){for(var f=this.eventListeners&&this.eventListeners[a]||[],d=0,c=f.length;d<c;++d)if(f[d]===g)return f.splice(d,1)},dispatchEvent:function(a){for(var g=a.type,g=this.eventListeners&&this.eventListeners[g]||[],f=0;f<g.length;f++)"function"===typeof g[f]?g[f].call(this,a):g[f].handleEvent(a);return!!a.defaultPrevented}}}function n(a){a=a("./core");h(a)}var m=[].push;"undefined"!==typeof module&&module.exports&&
"function"===typeof require?n(require):h(q)})();(function(h){function n(l){function g(a,c){function f(){c.message=b+c.message;throw c;}var b=a+" threw exception: ";l.log(b+"["+c.name+"] "+c.message);c.stack&&l.log(c.stack);g.useImmediateExceptions?f():g.setTimeout(f,0)}g.useImmediateExceptions=!1;g.setTimeout=function(d,c){a(d,c)};var f={};f.log=l.log=function(){};f.logError=l.logError=g;return f}function m(a,g,f){a=a("./util/core");f.exports=n(a)}var a=setTimeout;"undefined"!==typeof module&&module.exports&&
"function"===typeof require?m(require,module.exports,module):h&&n(h)})("object"===typeof q&&q);"undefined"===typeof q&&("undefined"===typeof this?("undefined"!==typeof window?window:global).sinon={}:this.sinon={});(function(h){function n(l){function g(){this.readyState=g.UNSENT;this.requestBody=null;this.requestHeaders={};this.status=0;this.timeout=null;if("function"===typeof g.onCreate)g.onCreate(this)}l.xdr=a;l.extend(g.prototype,l.EventTarget,{open:function(a,d){this.method=a;this.url=d;this.responseText=
null;this.sendFlag=!1;this.readyStateChange(g.OPENED)},readyStateChange:function(a){this.readyState=a;a="";switch(this.readyState){case g.LOADING:this.sendFlag&&(a="onprogress");break;case g.DONE:a=this.isTimeout?"ontimeout":this.errorFlag||200>this.status||299<this.status?"onerror":"onload"}if(a&&"function"===typeof this[a])try{this[a]()}catch(d){l.logError("Fake XHR "+a+" handler",d)}},send:function(a){if(this.readyState!==g.OPENED)throw Error("INVALID_STATE_ERR");if(this.sendFlag)throw Error("INVALID_STATE_ERR");
/^(get|head)$/i.test(this.method)||(this.requestBody=a);this.requestHeaders["Content-Type"]="text/plain;charset\x3dutf-8";this.errorFlag=!1;this.sendFlag=!0;this.readyStateChange(g.OPENED);if("function"===typeof this.onSend)this.onSend(this)},abort:function(){this.aborted=!0;this.responseText=null;this.errorFlag=!0;this.readyState>l.FakeXDomainRequest.UNSENT&&this.sendFlag&&(this.readyStateChange(l.FakeXDomainRequest.DONE),this.sendFlag=!1)},setResponseBody:function(a){if(this.readyState===g.UNSENT)throw Error("Request not sent");
if(this.readyState===g.DONE)throw Error("Request done");if("string"!==typeof a)throw a=Error("Attempted to respond to fake XDomainRequest with "+a+", which is not a string."),a.name="InvalidBodyException",a;var d=this.chunkSize||10,c=0;this.responseText="";do this.readyStateChange(g.LOADING),this.responseText+=a.substring(c,c+d),c+=d;while(c<a.length);this.readyStateChange(g.DONE)},respond:function(a,d,c){this.status="number"===typeof a?a:200;this.setResponseBody(c||"")},simulatetimeout:function(){this.status=
0;this.isTimeout=!0;this.responseText=void 0;this.readyStateChange(g.DONE)}});l.extend(g,{UNSENT:0,OPENED:1,LOADING:3,DONE:4});l.useFakeXDomainRequest=function(){l.FakeXDomainRequest.restore=function(f){a.supportsXDR&&(h.XDomainRequest=a.GlobalXDomainRequest);delete l.FakeXDomainRequest.restore;!0!==f&&delete l.FakeXDomainRequest.onCreate};a.supportsXDR&&(h.XDomainRequest=l.FakeXDomainRequest);return l.FakeXDomainRequest};l.FakeXDomainRequest=g}function m(a,g,f){g=a("./core");a("../extend");a("./event");
a("../log_error");n(g);f.exports=g}var a={XDomainRequest:h.XDomainRequest};a.GlobalXDomainRequest=h.XDomainRequest;a.supportsXDR="undefined"!==typeof a.GlobalXDomainRequest;a.workingXDR=a.supportsXDR?a.GlobalXDomainRequest:!1;"undefined"!==typeof module&&module.exports&&"function"===typeof require?m(require,module.exports,module):n(q)})("undefined"!==typeof global?global:self);(function(h,n){function m(){this.eventListeners={progress:[],load:[],abort:[],error:[]}}function a(){function b(a){c.addEventListener(a,
function(b){var d=c["on"+a];d&&"function"===typeof d&&d.call(this,b)})}this.readyState=a.UNSENT;this.requestHeaders={};this.requestBody=null;this.status=0;this.statusText="";this.upload=new m;this.response=this.responseType="";t.supportsCORS&&(this.withCredentials=!1);for(var c=this,d=["loadstart","load","abort","loadend"],e=d.length-1;0<=e;e--)b(d[e]);if("function"===typeof a.onCreate)a.onCreate(this)}function l(b){if(b.readyState!==a.OPENED)throw Error("INVALID_STATE_ERR");if(b.sendFlag)throw Error("INVALID_STATE_ERR");
}function g(a,b){b=b.toLowerCase();for(var c in a)if(c.toLowerCase()===b)return c;return null}function f(a,b){if(a)for(var c=0,d=a.length;c<d;c+=1)b(a[c])}function d(a,b){for(var c=0;c<a.length;c++)if(!0===b(a[c]))return!0;return!1}function c(a){for(var b=new ArrayBuffer(a.length),c=new Uint8Array(b),d=0;d<a.length;d++){var e=a.charCodeAt(d);if(256<=e)throw new TypeError("arraybuffer or blob responseTypes require binary string, invalid character "+a[d]+" found.");c[d]=e}return b}function k(a){return!a||
/(text\/xml)|(application\/xml)|(\+xml)/.test(a)}function b(b,d,e){if(""===b||"text"===b)return e;if(w&&"arraybuffer"===b)return c(e);if("json"===b)try{return JSON.parse(e)}catch(f){return null}else{if(u&&"blob"===b)return b={},d&&(b.type=d),new Blob([c(e)],b);if("document"===b)return k(d)?a.parseXML(e):null}throw Error("Invalid responseType "+b);}function p(a){a.response=""===a.responseType||"text"===a.responseType?a.responseText="":a.responseText=null;a.responseXML=null}function e(c){c.xhr=t;c.extend(a.prototype,
c.EventTarget,{async:!0,open:function(b,c,e,f,g){this.method=b;this.url=c;this.async="boolean"===typeof e?e:!0;this.username=f;this.password=g;p(this);this.requestHeaders={};this.sendFlag=!1;if(!0===a.useFilters){var k=arguments;if(d(a.filters,function(a){return a.apply(this,k)}))return a.defake(this,arguments)}this.readyStateChange(a.OPENED)},readyStateChange:function(b){this.readyState=b;b=new c.Event("readystatechange",!1,!1,this);if("function"===typeof this.onreadystatechange)try{this.onreadystatechange(b)}catch(d){c.logError("Fake XHR onreadystatechange handler",
d)}switch(this.readyState){case a.DONE:s&&(this.upload.dispatchEvent(new c.ProgressEvent("progress",{loaded:100,total:100})),this.dispatchEvent(new c.ProgressEvent("progress",{loaded:100,total:100}))),this.upload.dispatchEvent(new c.Event("load",!1,!1,this)),this.dispatchEvent(new c.Event("load",!1,!1,this)),this.dispatchEvent(new c.Event("loadend",!1,!1,this))}this.dispatchEvent(b)},setRequestHeader:function(a,b){l(this);if(x[a]||/^(Sec-|Proxy-)/.test(a))throw Error('Refused to set unsafe header "'+
a+'"');this.requestHeaders[a]=this.requestHeaders[a]?this.requestHeaders[a]+(","+b):b},setResponseHeaders:function(b){if(this.readyState!==a.OPENED)throw Error("INVALID_STATE_ERR - "+this.readyState);this.responseHeaders={};for(var c in b)b.hasOwnProperty(c)&&(this.responseHeaders[c]=b[c]);this.async?this.readyStateChange(a.HEADERS_RECEIVED):this.readyState=a.HEADERS_RECEIVED},send:function(b){l(this);if(!/^(get|head)$/i.test(this.method)){var d=g(this.requestHeaders,"Content-Type");if(this.requestHeaders[d]){var e=
this.requestHeaders[d].split(";");this.requestHeaders[d]=e[0]+";charset\x3dutf-8"}else!z||b instanceof FormData||(this.requestHeaders["Content-Type"]="text/plain;charset\x3dutf-8");this.requestBody=b}this.errorFlag=!1;this.sendFlag=this.async;p(this);this.readyStateChange(a.OPENED);if("function"===typeof this.onSend)this.onSend(this);this.dispatchEvent(new c.Event("loadstart",!1,!1,this))},abort:function(){this.aborted=!0;p(this);this.errorFlag=!0;this.requestHeaders={};this.responseHeaders={};this.readyState>
a.UNSENT&&this.sendFlag&&(this.readyStateChange(a.DONE),this.sendFlag=!1);this.readyState=a.UNSENT;this.dispatchEvent(new c.Event("abort",!1,!1,this));this.upload.dispatchEvent(new c.Event("abort",!1,!1,this));if("function"===typeof this.onerror)this.onerror()},getResponseHeader:function(b){if(this.readyState<a.HEADERS_RECEIVED||/^Set-Cookie2?$/i.test(b))return null;b=g(this.responseHeaders,b);return this.responseHeaders[b]||null},getAllResponseHeaders:function(){if(this.readyState<a.HEADERS_RECEIVED)return"";
var b="",c;for(c in this.responseHeaders)this.responseHeaders.hasOwnProperty(c)&&!/^Set-Cookie2?$/i.test(c)&&(b+=c+": "+this.responseHeaders[c]+"\r\n");return b},setResponseBody:function(c){if(this.readyState===a.DONE)throw Error("Request done");if(this.async&&this.readyState!==a.HEADERS_RECEIVED)throw Error("No headers received");if("string"!==typeof c)throw c=Error("Attempted to respond to fake XMLHttpRequest with "+c+", which is not a string."),c.name="InvalidBodyException",c;var d=this.getResponseHeader("Content-Type"),
e=""===this.responseType||"text"===this.responseType;p(this);if(this.async){var f=this.chunkSize||10,g=0;do this.readyStateChange(a.LOADING),e&&(this.responseText=this.response+=c.substring(g,g+f)),g+=f;while(g<c.length)}this.response=b(this.responseType,d,c);e&&(this.responseText=this.response);"document"===this.responseType?this.responseXML=this.response:""===this.responseType&&k(d)&&(this.responseXML=a.parseXML(this.responseText));this.readyStateChange(a.DONE)},respond:function(b,c,d){this.status=
"number"===typeof b?b:200;this.statusText=a.statusCodes[this.status];this.setResponseHeaders(c||{});this.setResponseBody(d||"")},uploadProgress:function(a){s&&this.upload.dispatchEvent(new c.ProgressEvent("progress",a))},downloadProgress:function(a){s&&this.dispatchEvent(new c.ProgressEvent("progress",a))},uploadError:function(a){r&&this.upload.dispatchEvent(new c.CustomEvent("error",{detail:a}))}});c.extend(a,{UNSENT:0,OPENED:1,HEADERS_RECEIVED:2,LOADING:3,DONE:4});c.useFakeXMLHttpRequest=function(){a.restore=
function(b){t.supportsXHR&&(n.XMLHttpRequest=t.GlobalXMLHttpRequest);t.supportsActiveX&&(n.ActiveXObject=t.GlobalActiveXObject);delete a.restore;!0!==b&&delete a.onCreate};t.supportsXHR&&(n.XMLHttpRequest=a);t.supportsActiveX&&(n.ActiveXObject=function(b){return"Microsoft.XMLHTTP"===b||/^Msxml2\.XMLHTTP/i.test(b)?new a:new t.GlobalActiveXObject(b)});return a};c.FakeXMLHttpRequest=a}function q(a,b,c){b=a("./core");a("../extend");a("./event");a("../log_error");e(b);c.exports=b}var s="undefined"!==typeof ProgressEvent,
r="undefined"!==typeof CustomEvent,z="undefined"!==typeof FormData,w="undefined"!==typeof ArrayBuffer,u="function"===typeof Blob,t={XMLHttpRequest:n.XMLHttpRequest};t.GlobalXMLHttpRequest=n.XMLHttpRequest;t.GlobalActiveXObject=n.ActiveXObject;t.supportsActiveX="undefined"!==typeof t.GlobalActiveXObject;t.supportsXHR="undefined"!==typeof t.GlobalXMLHttpRequest;t.workingXHR=function(a){return"undefined"!==typeof a.XMLHttpRequest?a.XMLHttpRequest:"undefined"!==typeof a.ActiveXObject?function(){return new a.ActiveXObject("MSXML2.XMLHTTP.3.0")}:
!1}(n);t.supportsCORS=t.supportsXHR&&"withCredentials"in new t.GlobalXMLHttpRequest;var x={"Accept-Charset":!0,"Accept-Encoding":!0,Connection:!0,"Content-Length":!0,Cookie:!0,Cookie2:!0,"Content-Transfer-Encoding":!0,Date:!0,Expect:!0,Host:!0,"Keep-Alive":!0,Referer:!0,TE:!0,Trailer:!0,"Transfer-Encoding":!0,Upgrade:!0,"User-Agent":!0,Via:!0};m.prototype.addEventListener=function(a,b){this.eventListeners[a].push(b)};m.prototype.removeEventListener=function(a,b){for(var c=this.eventListeners[a]||
[],d=0,e=c.length;d<e;++d)if(c[d]===b)return c.splice(d,1)};m.prototype.dispatchEvent=function(a){for(var b=this.eventListeners[a.type]||[],c=0,d;null!=(d=b[c]);c++)d(a)};var v=function(a,b,c){switch(c.length){case 0:return a[b]();case 1:return a[b](c[0]);case 2:return a[b](c[0],c[1]);case 3:return a[b](c[0],c[1],c[2]);case 4:return a[b](c[0],c[1],c[2],c[3]);case 5:return a[b](c[0],c[1],c[2],c[3],c[4])}};a.filters=[];a.addFilter=function(a){this.filters.push(a)};var B=/MSIE 6/;a.defake=function(b,
c){var d=new t.workingXHR;f("open setRequestHeader send abort getResponseHeader getAllResponseHeaders addEventListener overrideMimeType removeEventListener".split(" "),function(a){b[a]=function(){return v(d,a,arguments)}});var e=function(a){f(a,function(a){try{b[a]=d[a]}catch(c){if(!B.test(navigator.userAgent))throw c;}})},g=function(){b.readyState=d.readyState;d.readyState>=a.HEADERS_RECEIVED&&e(["status","statusText"]);d.readyState>=a.LOADING&&e(["responseText","response"]);d.readyState===a.DONE&&
e(["responseXML"]);b.onreadystatechange&&b.onreadystatechange.call(b,{target:b})};if(d.addEventListener){for(var k in b.eventListeners)b.eventListeners.hasOwnProperty(k)&&f(b.eventListeners[k],function(a){d.addEventListener(k,a)});d.addEventListener("readystatechange",g)}else d.onreadystatechange=g;v(d,"open",c)};a.useFilters=!1;a.parseXML=function(a){if(""!==a)try{if("undefined"!==typeof DOMParser)return(new DOMParser).parseFromString(a,"text/xml");var b=new window.ActiveXObject("Microsoft.XMLDOM");
b.async="false";b.loadXML(a);return b}catch(c){}return null};a.statusCodes={100:"Continue",101:"Switching Protocols",200:"OK",201:"Created",202:"Accepted",203:"Non-Authoritative Information",204:"No Content",205:"Reset Content",206:"Partial Content",207:"Multi-Status",300:"Multiple Choice",301:"Moved Permanently",302:"Found",303:"See Other",304:"Not Modified",305:"Use Proxy",307:"Temporary Redirect",400:"Bad Request",401:"Unauthorized",402:"Payment Required",403:"Forbidden",404:"Not Found",405:"Method Not Allowed",
406:"Not Acceptable",407:"Proxy Authentication Required",408:"Request Timeout",409:"Conflict",410:"Gone",411:"Length Required",412:"Precondition Failed",413:"Request Entity Too Large",414:"Request-URI Too Long",415:"Unsupported Media Type",416:"Requested Range Not Satisfiable",417:"Expectation Failed",422:"Unprocessable Entity",500:"Internal Server Error",501:"Not Implemented",502:"Bad Gateway",503:"Service Unavailable",504:"Gateway Timeout",505:"HTTP Version Not Supported"};"undefined"!==typeof module&&
module.exports&&"function"===typeof require?q(require,module.exports,module):h&&e(h)})("object"===typeof q&&q,"undefined"!==typeof global?global:self);(function(){function h(a){var d=a;"[object Array]"!==Object.prototype.toString.call(a)&&(d=[200,{},a]);if("string"!==typeof d[2])throw new TypeError("Fake server response body should be string, but was "+typeof d[2]);return d}function n(f){f.fakeServer={create:function(a){var c=f.create(this);c.configure(a);this.xhr=f.xhr.supportsCORS?f.useFakeXMLHttpRequest():
f.useFakeXDomainRequest();c.requests=[];this.xhr.onCreate=function(a){c.addRequest(a)};return c},configure:function(a){var c={autoRespond:!0,autoRespondAfter:!0,respondImmediately:!0,fakeHTTPMethods:!0},f;a=a||{};for(f in a)c.hasOwnProperty(f)&&a.hasOwnProperty(f)&&(this[f]=a[f])},addRequest:function(d){var c=this;a.call(this.requests,d);d.onSend=function(){c.handleRequest(this);c.respondImmediately?c.respond():c.autoRespond&&!c.responding&&(setTimeout(function(){c.responding=!1;c.respond()},c.autoRespondAfter||
10),c.responding=!0)}},getHTTPMethod:function(a){if(this.fakeHTTPMethods&&/post/i.test(a.method)){var c=(a.requestBody||"").match(/_method=([^\b;]+)/);return c?c[1]:a.method}return a.method},handleRequest:function(d){d.async?(this.queue||(this.queue=[]),a.call(this.queue,d)):this.processRequest(d)},log:function(a,c){var g;g="Request:\n"+f.format(c)+"\n\n";g+="Response:\n"+f.format(a)+"\n\n";f.log(g)},respondWith:function(d,c,f){1===arguments.length&&"function"!==typeof d?this.response=h(d):(this.responses||
(this.responses=[]),1===arguments.length&&(f=d,c=d=null),2===arguments.length&&(f=c,c=d,d=null),a.call(this.responses,{method:d,url:c,response:"function"===typeof f?f:h(f)}))},respond:function(){0<arguments.length&&this.respondWith.apply(this,arguments);for(var a=this.queue||[],a=a.splice(0,a.length),c=0;c<a.length;c++)this.processRequest(a[c])},processRequest:function(a){try{if(!a.aborted){var c=this.response||[404,{},""];if(this.responses)for(var k=this.responses.length-1;0<=k;k--){var b;var h=
this.responses[k],e=a,l=e.url;if(!/^https?:\/\//.test(l)||g.test(l))l=l.replace(g,"");var m=h,n=this.getHTTPMethod(e),q=l,w=m.method,u=!w||w.toLowerCase()===n.toLowerCase(),t=m.url,x=!t||t===q||"function"===typeof t.test&&t.test(q);if(u&&x)if("function"===typeof h.response){var v=h.url,B=[e].concat(v&&"function"===typeof v.exec?v.exec(l).slice(1):[]);b=h.response.apply(h,B)}else b=!0;else b=!1;if(b){c=this.responses[k].response;break}}4!==a.readyState&&(this.log(c,a),a.respond(c[0],c[1],c[2]))}}catch(C){f.logError("Fake server request processing",
C)}},restore:function(){return this.xhr.restore&&this.xhr.restore.apply(this.xhr,arguments)}}}function m(a,d,c){d=a("./core");a("./fake_xdomain_request");a("./fake_xml_http_request");a("../format");n(d);c.exports=d}var a=[].push,l="undefined"!==typeof window?window.location:{},g=new RegExp("^"+l.protocol+"//"+l.host);"undefined"!==typeof module&&module.exports&&"function"===typeof require?m(require,module.exports,module):n(q)})();(function(){function h(h){function a(){}a.prototype=h.fakeServer;h.fakeServerWithClock=
new a;h.fakeServerWithClock.addRequest=function(a){if(a.async&&("object"===typeof setTimeout.clock?this.clock=setTimeout.clock:(this.clock=h.useFakeTimers(),this.resetClock=!0),!this.longestTimeout)){var g=this.clock.setTimeout,f=this.clock.setInterval,d=this;this.clock.setTimeout=function(a,f){d.longestTimeout=Math.max(f,d.longestTimeout||0);return g.apply(this,arguments)};this.clock.setInterval=function(a,g){d.longestTimeout=Math.max(g,d.longestTimeout||0);return f.apply(this,arguments)}}return h.fakeServer.addRequest.call(this,
a)};h.fakeServerWithClock.respond=function(){var a=h.fakeServer.respond.apply(this,arguments);this.clock&&(this.clock.tick(this.longestTimeout||0),this.longestTimeout=0,this.resetClock&&(this.clock.restore(),this.resetClock=!1));return a};h.fakeServerWithClock.restore=function(){this.clock&&this.clock.restore();return h.fakeServer.restore.apply(this,arguments)}}function n(m){var a=m("./core");m("./fake_server");m("./fake_timers");h(a)}"undefined"!==typeof module&&module.exports&&"function"===typeof require?
n(require):h(q)})();(function(h){function n(a){function h(a,d,c,k){k&&(!d.injectInto||c in d.injectInto?g.call(a.args,k):(d.injectInto[c]=k,a.injectedKeys.push(c)))}var g=[].push;a.sandbox=a.extend(a.create(a.collection),{useFakeTimers:function(){this.clock=a.useFakeTimers.apply(a,arguments);return this.add(this.clock)},serverPrototype:a.fakeServer,useFakeServer:function(){var f=this.serverPrototype||a.fakeServer;if(!f||!f.create)return null;this.server=f.create();return this.add(this.server)},inject:function(f){a.collection.inject.call(this,
f);this.clock&&(f.clock=this.clock);this.server&&(f.server=this.server,f.requests=this.server.requests);f.match=a.match;return f},restore:function(){a.collection.restore.apply(this,arguments);this.restoreContext()},restoreContext:function(){if(this.injectedKeys){for(var a=0,d=this.injectedKeys.length;a<d;a++)delete this.injectInto[this.injectedKeys[a]];this.injectedKeys=[]}},create:function(f){if(!f)return a.create(a.sandbox);var d=a.create(a.sandbox);f.useFakeServer&&("object"===typeof f.useFakeServer&&
(d.serverPrototype=f.useFakeServer),d.useFakeServer());f.useFakeTimers&&("object"===typeof f.useFakeTimers?d.useFakeTimers.apply(d,f.useFakeTimers):d.useFakeTimers());d.args=d.args||[];d.injectedKeys=[];d.injectInto=f.injectInto;var c,g,b=d.inject({});if(f.properties)for(var p=0,e=f.properties.length;p<e;p++)c=f.properties[p],g=b[c]||"sandbox"===c&&d,h(d,f,c,g);else h(d,f,"sandbox",g);return d},match:a.match});a.sandbox.useFakeXMLHttpRequest=a.sandbox.useFakeServer;return a.sandbox}function m(a,h,
g){h=a("./util/core");a("./extend");a("./util/fake_server_with_clock");a("./util/fake_timers");a("./collection");g.exports=n(h)}"undefined"!==typeof module&&module.exports&&"function"===typeof require?m(require,module.exports,module):h&&n(h)})("object"===typeof q&&q);(function(h){function n(a){function h(f){function d(){var c=a.getConfig(a.config);c.injectInto=c.injectIntoThis&&this||c.injectInto;var b=a.sandbox.create(c),c=g.call(arguments),d=c.length&&c[c.length-1],e,h;"function"===typeof d&&(c[c.length-
1]=function(a){a?b.restore():b.verifyAndRestore();d(a)});try{h=f.apply(this,c.concat(b.args))}catch(l){e=l}if("function"!==typeof d){if("undefined"!==typeof e)throw b.restore(),e;b.verifyAndRestore()}return h}var c=typeof f;if("function"!==c)throw new TypeError("sinon.test needs to wrap a test function, got "+c);return f.length?function(a){return d.apply(this,arguments)}:d}var g=Array.prototype.slice;h.config={injectIntoThis:!0,injectInto:null,properties:"spy stub mock clock server requests".split(" "),
useFakeTimers:!0,useFakeServer:!0};return a.test=h}function m(a,h,g){h=a("./util/core");a("./sandbox");g.exports=n(h)}"undefined"!==typeof module&&module.exports&&"function"===typeof require?m(require,module.exports,module):h&&n(h)})("object"===typeof q&&q||null);(function(h){function n(a,g,f){return function(){g&&g.apply(this,arguments);var d,c;try{c=a.apply(this,arguments)}catch(h){d=h}f&&f.apply(this,arguments);if(d)throw d;return c}}function m(a){function g(f,d){if(!f||"object"!==typeof f)throw new TypeError("sinon.testCase needs an object with test functions");
var c=new RegExp("^"+(d||"test")),g={},b=f.setUp,h=f.tearDown,e,m,q;for(e in f)if(f.hasOwnProperty(e)&&!/^(setUp|tearDown)$/.test(e))if(m=f[e],"function"===typeof m&&c.test(e)){q=m;if(b||h)q=n(m,b,h);g[e]=a.test(q)}else g[e]=f[e];return g}return a.testCase=g}function a(a,g,f){g=a("./util/core");a("./test");f.exports=m(g)}"undefined"!==typeof module&&module.exports&&"function"===typeof require?a(require,module.exports,module):h&&m(h)})("object"===typeof q&&q);(function(h,n){function m(a){function f(){for(var a,
c=0,d=arguments.length;c<d;++c)(a=arguments[c])||h.fail("fake is not a spy"),a.proxy&&a.proxy.isSinonProxy?f(a.proxy):("function"!==typeof a&&h.fail(a+" is not a function"),"function"!==typeof a.getCall&&h.fail(a+" is not stubbed"))}function d(a,c){a=a||n;(a.fail||h.fail).call(a,c)}function c(a,c,e){2===arguments.length&&(e=c,c=a);h[a]=function(g){f(g);var m=l.call(arguments,1),n=!1;(n="function"===typeof c?!c(g):"function"===typeof g[c]?!g[c].apply(g,m):!g[c])?d(this,(g.printf||g.proxy.printf).apply(g,
[e].concat(m))):h.pass(a)}}var h;h={failException:"AssertError",fail:function(a){a=Error(a);a.name=this.failException||h.failException;throw a;},pass:function(){},callOrder:function(){f.apply(null,arguments);var b="",c="";if(a.calledInOrder(arguments))h.pass("callOrder");else{try{for(var b=[].join.call(arguments,", "),e=l.call(arguments),m=e.length;m;)e[--m].called||e.splice(m,1);c=a.orderByFirstCall(e).join(", ")}catch(n){}d(this,"expected "+b+" to be called in order but were called as "+c)}},callCount:function(b,
c){f(b);if(b.callCount!==c){var e="expected %n to be called "+a.timesInWords(c)+" but was called %c%C";d(this,b.printf(e))}else h.pass("callCount")},expose:function(a,c){if(!a)throw new TypeError("target is null or undefined");var d=c||{},f="undefined"===typeof d.prefix&&"assert"||d.prefix,d="undefined"===typeof d.includeFail||!!d.includeFail,g;for(g in this)if("expose"!==g&&(d||!/^(fail)/.test(g))){var h;h=f;var k=g;h=!h||/^fail/.test(k)?k:h+k.slice(0,1).toUpperCase()+k.slice(1);a[h]=this[g]}return a},
match:function(b,c){if(a.match(c).test(b))h.pass("match");else{var e=["expected value to match","    expected \x3d "+a.format(c),"    actual \x3d "+a.format(b)];d(this,e.join("\n"))}}};c("called","expected %n to have been called at least once but was never called");c("notCalled",function(a){return!a.called},"expected %n to not have been called but was called %c%C");c("calledOnce","expected %n to be called once but was called %c%C");c("calledTwice","expected %n to be called twice but was called %c%C");
c("calledThrice","expected %n to be called thrice but was called %c%C");c("calledOn","expected %n to be called with %1 as this but was called with %t");c("alwaysCalledOn","expected %n to always be called with %1 as this but was called with %t");c("calledWithNew","expected %n to be called with new");c("alwaysCalledWithNew","expected %n to always be called with new");c("calledWith","expected %n to be called with arguments %*%C");c("calledWithMatch","expected %n to be called with match %*%C");c("alwaysCalledWith",
"expected %n to always be called with arguments %*%C");c("alwaysCalledWithMatch","expected %n to always be called with match %*%C");c("calledWithExactly","expected %n to be called with exact arguments %*%C");c("alwaysCalledWithExactly","expected %n to always be called with exact arguments %*%C");c("neverCalledWith","expected %n to never be called with arguments %*%C");c("neverCalledWithMatch","expected %n to never be called with match %*%C");c("threw","%n did not throw exception%C");c("alwaysThrew",
"%n did not always throw exception%C");return a.assert=h}function a(a,f,d){f=a("./util/core");a("./match");a("./format");d.exports=m(f)}var l=Array.prototype.slice;"undefined"!==typeof module&&module.exports&&"function"===typeof require?a(require,module.exports,module):h&&m(h)})("object"===typeof q&&q,"undefined"!==typeof global?global:self);return q});